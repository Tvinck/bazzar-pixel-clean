# üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ Bazzar Pixel

–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: **–°—Ç–∞–±–∏–ª—å–Ω–æ–µ –±–µ—Ç–∞-–≤–µ—Ä—Å–∏—è**.
–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –æ–ø–ª–∞—Ç–∞, –∏—Å—Ç–æ—Ä–∏—è) —Ä–∞–±–æ—Ç–∞–µ—Ç. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kie.ai –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.

–û–¥–Ω–∞–∫–æ, –µ—Å—Ç—å —Ä—è–¥ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º** –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö **—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π**, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

---

## üö® 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –£—è–∑–≤–∏–º–æ—Å—Ç–∏ (Security)

### üî¥ –ü–æ–¥–¥–µ–ª–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Spoofing)
**–ü—Ä–æ–±–ª–µ–º–∞**: –í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API (`/api/generate`) –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ `telegramId`, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–º—É –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞.
**–†–∏—Å–∫**: –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å —Å —á—É–∂–∏–º `telegramId` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞) –∏ —Å–ø–∏—Å–∞—Ç—å –µ–≥–æ –±–∞–ª–∞–Ω—Å –¥–ª—è —Å–≤–æ–∏—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π. –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ (`signature`) –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ª–µ–≥—Ä–∞–º.
**–†–µ—à–µ–Ω–∏–µ**:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º **Telegram Init Data Validation**.
2. –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É `window.Telegram.WebApp.initData`.
3. –ù–∞ –±–µ–∫–µ–Ω–¥–µ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å—å —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–º–æ—â—å—é —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–æ–≤–µ—Ä—è—Ç—å `user_id` –≤–Ω—É—Ç—Ä–∏ –Ω–µ—ë.

---

## üèóÔ∏è 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã

### ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (Single Source of Truth)
**–ü—Ä–æ–±–ª–µ–º–∞**: –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π –∏, —á—Ç–æ —Ö—É–∂–µ, **—Ü–µ–Ω—ã** –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:
1. `bot.js` (`MODEL_CATALOG` –∏ `PRICING`) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è.
2. `GenerationView.jsx` (`getCost`, `getModes`) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
**–†–∏—Å–∫**: –ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏—Ç–µ —Ü–µ–Ω—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç —Å—Ç–∞—Ä—É—é —Ü–µ–Ω—É –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ, –Ω–æ —Å–ø–∏—à–µ—Ç—Å—è –¥—Ä—É–≥–∞—è —Å—É–º–º–∞. –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –∂–∞–ª–æ–±–∞–º.
**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç `GET /api/config`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∂–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.

### üì¶ –ú–æ–Ω–æ–ª–∏—Ç–Ω–æ—Å—Ç—å `bot.js`
**–ü—Ä–æ–±–ª–µ–º–∞**: –§–∞–π–ª —Ä–∞–∑—Ä–æ—Å—Å—è –¥–æ 1500 —Å—Ç—Ä–æ–∫. –í –Ω–µ–º —Å–º–µ—à–∞–Ω—ã:
- –õ–æ–≥–∏–∫–∞ Telegram –±–æ—Ç–∞.
- Express —Å–µ—Ä–≤–µ—Ä API.
- –õ–æ–≥–∏–∫–∞ –æ–ø–ª–∞—Ç—ã.
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.
**–†–∏—Å–∫**: –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —á—Ä–µ–≤–∞—Ç–æ –ø–æ–ª–æ–º–∫–æ–π –≤—Å–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.
**–†–µ—à–µ–Ω–∏–µ**: –†–∞–∑–±–∏—Ç—å –Ω–∞ –º–æ–¥—É–ª–∏:
- `src/server/routes.js` (API)
- `src/bot/handlers.js` (Telegram –ª–æ–≥–∏–∫–∞)
- `src/config/models.js` (–ö–∞—Ç–∞–ª–æ–≥ –º–æ–¥–µ–ª–µ–π)

---

## üêõ 3. –ë–∞–≥–∏ –∏ –ù–µ–¥–æ—á–µ—Ç—ã (Bugs & UX)

### üìΩÔ∏è –í–∏–¥–µ–æ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
- **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤**: –î–ª—è –≤–∏–¥–µ–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (Kling) —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏ —Ñ–æ—Ç–æ, –∏ –≤–∏–¥–µ–æ. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ–π—á–∞—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –≤—Å—ë –≤ –∫—É—á—É. –õ—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å **–æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è** (Dropzones) –¥–ª—è "–†–µ—Ñ–µ—Ä–µ–Ω—Å —Ñ–æ—Ç–æ" –∏ "–†–µ—Ñ–µ—Ä–µ–Ω—Å –≤–∏–¥–µ–æ".
- **–ò–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ –¥–æ–ª–≥–∞—è (3-5 –º–∏–Ω—É—Ç). –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ù—É–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ **Webhooks** –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –±–æ—Ç –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (—Å–µ–π—á–∞—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –µ—Å—Ç—å, –Ω–æ –≤ UI –≤–µ–±-–∞–ø–ø–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å).

### üí≥ –û–ø–ª–∞—Ç–∞
- **–í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤**: –ï—Å–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–ø–∞–ª–∞ —Å –æ—à–∏–±–∫–æ–π *–ø–æ—Å–ª–µ* —Å–ø–∏—Å–∞–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Kie.ai –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É, –Ω–æ –Ω–µ 402), –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç (refund)? –í –∫–æ–¥–µ `bot.js` —è –≤–∏–∂—É `process_generation_payment`, –Ω–æ –Ω–µ –≤–∏–∂—É `refund_payment` –≤ –±–ª–æ–∫–µ `catch`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—Ç–µ—Ä—è–µ—Ç –¥–µ–Ω—å–≥–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

---

## üöÄ 4. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é (Features)

### ‚úÖ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ
1. **–ï–¥–∏–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ –º–æ–¥–µ–ª–µ–π**: –í—ã–Ω–µ—Å—Ç–∏ `MODEL_CATALOG` –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π JSON/JS —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏ –≤ `bot.js`, –∏ –æ—Ç–¥–∞–µ—Ç—Å—è –ø–æ API –Ω–∞ —Ñ—Ä–æ–Ω—Ç.
2. **–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (Queue)**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –∏–ª–∏ PgBoss –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π. –°–µ–π—á–∞—Å –≤—Å—ë –≤ –ø–∞–º—è—Ç–∏. –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–∞ –≤–∏–¥–µ–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–æ–ª–≥–æ) ‚Äî –∑–∞–¥–∞—á–∞ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è.

### ‚ú® –ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ
1. **–ü—Ä–µ–≤—å—é —Å—Ç–∏–ª–µ–π**: –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏ –º–∞–ª–µ–Ω—å–∫–∏–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏-–ø—Ä–∏–º–µ—Ä—ã —Ç–æ–≥–æ, –∫–∞–∫ —Ä–∏—Å—É–µ—Ç —ç—Ç–∞ –º–æ–¥–µ–ª—å. –¢–µ–∫—Å—Ç "Seedream 4.5" –Ω–∏ –æ —á–µ–º –Ω–µ –≥–æ–≤–æ—Ä–∏—Ç –Ω–æ–≤–∏—á–∫—É.
2. **–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –±–∞–ª–∞–Ω—Å, –Ω–æ –Ω–µ –≤–∏–¥–∏—Ç, –∫—É–¥–∞ —É—à–ª–∏ –¥–µ–Ω—å–≥–∏. –ù—É–∂–µ–Ω —Ä–∞–∑–¥–µ–ª "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" –≤ –ø—Ä–æ—Ñ–∏–ª–µ.
3. **–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: "–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞, –ø–æ–ª—É—á–∏ 10 –∫—Ä–µ–¥–∏—Ç–æ–≤". –≠—Ç–æ –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Ä–æ—Å—Ç–∞ –¥–ª—è —Ç–∞–∫–∏—Ö –±–æ—Ç–æ–≤.

---

## üìù –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π (Roadmap)

1. **Hotfix**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API (–≤–∞–ª–∏–¥–∞—Ü–∏—è initData) ‚Äî **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**.
2. **Refactor**: –í—ã–Ω–µ—Å—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥ –º–æ–¥–µ–ª–µ–π –≤ –æ–±—â–∏–π —Ñ–∞–π–ª –∏ —Å–¥–µ–ª–∞—Ç—å API endpoint –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–∞.
3. **Reliability**: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º Refund (–≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤) –ø—Ä–∏ –æ—à–∏–±–∫–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
4. **Scale**: –†–∞–∑–±–∏—Ç—å `bot.js` –Ω–∞ –º–æ–¥—É–ª–∏.

---

*–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º Deepmind –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞.*
